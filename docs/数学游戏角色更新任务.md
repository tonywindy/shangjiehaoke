“AI冒险伙伴-悟空”功能需求文档
1. 功能概述
本项目旨在为“上节好课”游戏引入一个名为“悟空”的固定AI伙伴角色。该角色将从首页开始引导玩家，并在整个游戏过程中持续陪伴，根据玩家的操作和答题结果给予亲切活泼、鼓励性强的动态反馈。核心改动包括：将“提示”功能整合到伙伴对话框中，取代原有的页面跳转，以强化“AI学伴”的核心体验。

2. 角色设定 (Persona)
角色名称: 悟空

核心性格: 勇敢、活泼、充满能量的伙伴。

性格特点:

乐观积极: 总是充满热情，对挑战充满期待。

鼓励型伙伴: 玩家成功时，他会毫不吝啬地赞美；玩家失败时，他会第一时间给予鼓励和支持。

视觉形象: 经典的悟空形象，头戴金箍，身穿虎皮裙，手持金箍棒，眼神炯炯有神。

3. 界面与交互需求 (UI/UX)
3.1 首页 / 选择页

伙伴UI容器:

在HTML中创建一个ID为 ai-partner-container 的 <div> 容器。

使用CSS将其样式设置为 position: fixed; right: 20px; bottom: 20px;，使其固定在页面右下角。

初始状态:

页面加载完成后，悟空的默认形象和对话框立即出现。

初始对话: “小朋友，你好！我是你的冒险伙伴悟空！快来选择咱们要挑战的数学知识和冒险世界吧！”

3.2 游戏主页 / 答题页

伙伴UI容器:

保持在页面右下角，与首页位置和大小一致，确保视觉连贯性。

“提示”按钮交互变更:

必须修改：原有的“提示”按钮点击后跳转页面的逻辑需要被移除。

新逻辑: 点击“提示”按钮后，调用updatePartner函数，将AI生成的提示语显示在悟空的对话框中。

4. 功能逻辑与事件触发
伙伴的状态由“表情图片”和“对话内容”两个部分组成，由以下游戏事件触发。

事件1: 游戏开始

触发: 玩家点击“开始冒险”按钮，AI生成故事内容后。

表情: wukong_default.png

对话: “准备好了吗？我们的[玩家选择的冒险情景]马上就要开始啦！出发！” (注意：[玩家选择的冒险情景]需要被动态替换为实际选择的场景名称)。

事件2: 回答正确

触发: 玩家提交的答案被判定为正确。

表情: 立即切换为 wukong_happy.png。

对话: 从以下列表中 随机选择一句 显示:

“答对了！你真是个数学天才！”

“YES！又攻克一道难关！我们继续前进！”

“太厉害了！这个答案完美无缺！”

“我就知道，这点困难根本难不倒我们！”

后续: 2-3秒后，自动恢复为默认状态（wukong_default.png，对话框可清空或显示鼓励性短语如“继续加油！”）。

事件3: 回答错误

触发: 玩家提交的答案被判定为错误。

表情: 立即切换为 wukong_thinking.png。

对话: 从以下列表中 随机选择一句 显示:

“别灰心，强大的对手才能让我们变强！再试试看！”

“噢，这个答案似乎不太对。没关系，我们换个思路！”

“等等，好像掉进陷阱了。别担心，我们能找到正确的路！”

“这是一个小挑战！深呼吸，我们再来一次！”

后续: 2-3秒后，自动恢复为默认状态（wukong_default.png）。

事件4: 点击“提示”按钮

触发: 玩家点击“提示”按钮。

表情: 立即切换为 wukong_thinking.png。

对话: “让我想想... 提示是：” + [当前问题的原始提示文字] (注意：[当前问题的原始提示文字]需要从游戏数据中获取)。

后续: 保持此状态（思考表情和提示内容），直到玩家提交新答案。

事件5: 游戏完成

触发: 玩家完成所有5个章节的挑战。

表情: wukong_happy.png。

对话: “我们成功了！你完成了所有挑战，太了不起了！真期待我们下一次的冒险！”

5. 所需素材清单
角色: 悟空

图片文件 (PNG格式, 透明背景, 建议尺寸 200x200 像素):

wukong_default.png: 默认形象，手持金箍棒，威风凛凛地站立。

wukong_happy.png: 开心形象，开怀大笑或做出胜利的经典姿势。

wukong_thinking.png: 思考形象，挠着猴腮或做“火眼金睛”观察姿势。

6. 给AI编码器的实现建议
6.1 JavaScript 数据结构

建议使用一个对象来统一管理伙伴的所有数据，便于维护和调用。

const partnerData = {
    name: '悟空',
    images: {
        default: 'public/images/wukong_default.png',
        happy: 'public/images/wukong_happy.png',
        thinking: 'public/images/wukong_thinking.png'
    },
    dialogues: {
        correct: [
            "答对了！你真是个数学天才！",
            "YES！又攻克一道难关！我们继续前进！",
            "太厉害了！这个答案完美无缺！",
            "我就知道，这点困难根本难不倒我们！"
        ],
        incorrect: [
            "别灰心，强大的对手才能让我们变强！再试试看！",
            "噢，这个答案似乎不太对。没关系，我们换个思路！",
            "等等，好像掉进陷阱了。别担心，我们能找到正确的路！",
            "这是一个小挑战！深呼吸，我们再来一次！"
        ]
    }
};

6.2 核心控制函数

创建一个统一的函数来更新伙伴的UI，接收状态和自定义消息作为参数。

/**
 * 更新AI伙伴的显示状态
 * @param {string} state - 状态名称 ('default', 'happy', 'thinking')
 * @param {string} [customMessage] - 要显示的自定义消息，如果为空则使用预设对话
 */
function updatePartner(state, customMessage = '') {
    const partnerAvatar = document.getElementById('partner-avatar'); // 伙伴图片<img>的ID
    const partnerDialogue = document.getElementById('partner-dialogue-text'); // 伙伴对话<p>的ID

    // 更新图片
    partnerAvatar.src = partnerData.images[state];

    // 更新对话
    if (customMessage) {
        partnerDialogue.textContent = customMessage;
    } else {
        if (state === 'happy') {
            const dialogues = partnerData.dialogues.correct;
            partnerDialogue.textContent = dialogues[Math.floor(Math.random() * dialogues.length)];
        } else if (state === 'thinking') {
             // 此处可用于答错时的随机对话，提示功能使用customMessage
            const dialogues = partnerData.dialogues.incorrect;
            partnerDialogue.textContent = dialogues[Math.floor(Math.random() * dialogues.length)];
        }
        // ... 其他状态的默认对话
    }
}

6.3 事件绑定示例

// 提示按钮
const hintButton = document.getElementById('hint-button');
hintButton.addEventListener('click', () => {
    // 假设 currentHintText 存储了当前问题的提示
    const hintMessage = "让我想想... 提示是：" + currentHintText;
    updatePartner('thinking', hintMessage);
});

