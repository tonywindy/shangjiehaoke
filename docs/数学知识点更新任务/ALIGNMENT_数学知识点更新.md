# 数学知识点更新任务对齐文档

## 原始需求
用户要求将项目中的数学知识点更新为北师大版数学三年级上册知识点，按单元呈现，最后用户可以选择具体课时来选择数学知识点。

## 项目上下文分析

### 现有项目结构
- **主要文件**: `shuxueyouxi.html` (数学游戏主页面)
- **样式文件**: `public/shuxueyouxi-style.css`
- **脚本文件**: `public/shuxueyouxi-script.js`
- **技术栈**: HTML5 + CSS3 + JavaScript (ES6+)

### 现有知识点结构
当前项目按照5个大类组织知识点：
1. 🔢 数与运算 (4个知识点)
2. 🍰 分数的初步认识 (3个知识点)
3. ⚖️ 常见的量 (2个知识点)
4. 📐 图形与几何 (2个知识点)
5. 📊 数据的收集与整理 (2个知识点)

### 现有交互逻辑
- 用户可以选择1-3个知识点
- 知识点选择通过点击`.knowledge-item`元素实现
- 选择状态通过CSS类`selected`管理
- 选择的知识点存储在`selectedKnowledge`数组中

## 新需求分析

### 北师大版三年级上册知识点结构
按照8个单元组织，每个单元包含多个具体课时：

1. **第一单元 混合运算** (3个课时)
   - 1.1 小熊购物
   - 1.2 买文具
   - 1.3 过河

2. **第二单元 测量（二）** (3个课时)
   - 2.1 铅笔有多长
   - 2.2 1千米有多长
   - 2.3 旗杆有多高

3. **第三单元 大数加与减（二）** (5个课时)
   - 3.1 捐书
   - 3.2 小小养殖场
   - 3.3 节余多少钱
   - 3.4 身高的增长
   - 3.5 里程表

4. **第四单元 我们生活的空间（一）** (4个课时)
   - 4.1 看一看（一）
   - 4.2 看一看（二）
   - 4.3 看一看（三）
   - 4.4 看一看（四）

5. **第五单元 认识图形** (5个课时)
   - 5.1 认识角
   - 5.2 比一比
   - 5.3 认识直角
   - 5.4 长方形与正方形
   - 5.5 欣赏与设计

6. **第六单元 乘除法的应用（二）** (4个课时)
   - 6.1 包饺子
   - 6.2 需要多少钱
   - 6.3 丰收了
   - 6.4 植树

7. **第七单元 认识小数** (6个课时)
   - 7.1 水果店
   - 7.2 量身高
   - 7.3 货比三家
   - 7.4 存零用钱
   - 7.5 竹子的生长
   - 7.6 生活中的小数

8. **第八单元 调查与记录** (2个课时)
   - 8.1 评选吉祥物
   - 8.2 购买水果

## 边界确认

### 任务范围
- ✅ 更新HTML中的知识点选择界面结构
- ✅ 更新JavaScript中的知识点处理逻辑
- ✅ 保持现有的选择交互逻辑（1-3个选择）
- ✅ 保持现有的UI风格和响应式设计
- ✅ 确保与现有故事生成逻辑兼容

### 不包含的范围
- ❌ 不修改情景选择部分
- ❌ 不修改故事生成和答题逻辑
- ❌ 不修改CSS样式的整体风格
- ❌ 不修改AI API调用逻辑

## 需求理解

### 界面结构变更
1. **层级结构**: 单元 → 课时 → 知识点
2. **选择方式**: 用户选择具体课时，每个课时对应特定知识点
3. **显示方式**: 按单元分组，展开显示课时列表
4. **交互逻辑**: 保持1-3个选择的限制

### 数据结构变更
1. **知识点标识**: 从简单字符串改为"单元.课时"格式
2. **存储结构**: 需要包含单元信息、课时信息和具体知识点内容
3. **传递给AI**: 需要传递完整的知识点描述给故事生成API

## 疑问澄清

### 已确认的设计决策
1. **选择限制**: 保持1-3个知识点的选择限制
2. **界面风格**: 保持现有的渐变背景和卡片式设计
3. **响应式**: 保持移动端适配
4. **兼容性**: 确保与现有故事生成逻辑完全兼容

### 技术实现策略
1. **渐进式更新**: 先更新HTML结构，再更新JavaScript逻辑
2. **向后兼容**: 确保更新过程中不破坏现有功能
3. **数据映射**: 建立新旧知识点格式的映射关系

## 验收标准

1. **功能完整性**
   - 用户可以按单元浏览知识点
   - 用户可以选择具体课时对应的知识点
   - 选择限制（1-3个）正常工作
   - 选择状态正确显示和管理

2. **界面一致性**
   - 新界面与现有设计风格保持一致
   - 响应式布局在各设备上正常显示
   - 交互动画和悬停效果正常

3. **系统集成**
   - 选择的知识点能正确传递给故事生成API
   - 生成的故事内容与选择的知识点匹配
   - 不影响其他游戏功能（情景选择、答题等）

4. **用户体验**
   - 知识点选择界面清晰易懂
   - 单元和课时的层级关系明确
   - 选择操作流畅自然

## 风险评估

### 技术风险
- **低风险**: HTML结构更新相对简单
- **中风险**: JavaScript逻辑需要仔细处理数据格式变更
- **低风险**: CSS样式调整主要是布局优化

### 兼容性风险
- **中风险**: 需要确保新的知识点格式与AI故事生成兼容
- **低风险**: 现有选择逻辑相对稳定，变更影响可控

## 下一步行动
1. 设计新的知识点选择界面结构
2. 更新HTML文件
3. 更新JavaScript逻辑
4. 测试功能完整性
5. 验证与现有系统的集成