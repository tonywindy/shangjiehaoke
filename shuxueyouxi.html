<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI数学冒险故事</title>
    <link rel="stylesheet" href="/shuxueyouxi-style.css">
</head>
<body>

    <div id="game-container">
        <!-- 阶段一：知识点和情景选择界面 -->
        <div id="theme-selection-screen">
            <h1>🎯 选择你的数学冒险</h1>
            
            <div class="selection-container">
                <!-- 知识点选择区域 - 左侧 -->
                <div class="knowledge-selection">
                    <div class="selection-section">
                        <h2>📚 选择知识点（可多选）</h2>
                        <div class="knowledge-categories">
                            <div class="knowledge-category">
                                <h3>🔢 数与运算</h3>
                                <div class="knowledge-items">
                                    <div class="knowledge-item" data-knowledge="万以内数的认识">万以内数的认识</div>
                                    <div class="knowledge-item" data-knowledge="两位数除以一位数">两位数除以一位数</div>
                                    <div class="knowledge-item" data-knowledge="两位数乘两位数">两位数乘两位数</div>
                                    <div class="knowledge-item" data-knowledge="两步混合运算">两步混合运算</div>
                                </div>
                            </div>
                            
                            <div class="knowledge-category">
                                <h3>🍰 分数的初步认识</h3>
                                <div class="knowledge-items">
                                    <div class="knowledge-item" data-knowledge="认识几分之一">认识几分之一</div>
                                    <div class="knowledge-item" data-knowledge="分数的大小比较">分数的大小比较</div>
                                    <div class="knowledge-item" data-knowledge="分数的简单加减">分数的简单加减</div>
                                </div>
                            </div>
                            
                            <div class="knowledge-category">
                                <h3>⚖️ 常见的量</h3>
                                <div class="knowledge-items">
                                    <div class="knowledge-item" data-knowledge="时分秒">时、分、秒</div>
                                    <div class="knowledge-item" data-knowledge="长度质量单位">长度、质量单位</div>
                                </div>
                            </div>
                            
                            <div class="knowledge-category">
                                <h3>📐 图形与几何</h3>
                                <div class="knowledge-items">
                                    <div class="knowledge-item" data-knowledge="四边形性质与判定">四边形性质与判定</div>
                                    <div class="knowledge-item" data-knowledge="面积与周长">面积与周长</div>
                                </div>
                            </div>
                            
                            <div class="knowledge-category">
                                <h3>📊 数据的收集与整理</h3>
                                <div class="knowledge-items">
                                    <div class="knowledge-item" data-knowledge="条形统计图与数据">条形统计图与数据</div>
                                    <div class="knowledge-item" data-knowledge="两步应用题">两步应用题</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 情景选择区域 - 右侧 -->
                <div class="scenario-selection">
                    <div class="selection-section">
                        <h2>🎭 选择冒险情景（可多选）</h2>
                        <div id="scenario-cards">
                            <div class="scenario-card" data-scenario="神秘恐龙岛">🦖 神秘恐龙岛</div>
                            <div class="scenario-card" data-scenario="星际探险">🚀 星际探险</div>
                            <div class="scenario-card" data-scenario="魔法森林寻宝">🏰 魔法森林寻宝</div>
                            <div class="scenario-card" data-scenario="超级英雄拯救世界">🦸 超级英雄拯救世界</div>
                            <div class="scenario-card" data-scenario="海底探险">🐠 海底探险</div>
                            <div class="scenario-card" data-scenario="时空穿越">⏰ 时空穿越</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="selection-summary">
                <p>已选择知识点：<span id="selected-knowledge">无</span></p>
                <p>已选择情景：<span id="selected-scenarios">无</span></p>
            </div>
            
            <button id="start-adventure-btn" disabled>开始冒险！</button>
        </div>

        <!-- 阶段二：故事生成与展示界面 -->
        <div id="story-screen" class="hidden">
            <!-- 返回按钮 -->
            <button id="back-to-home-btn" class="back-btn">← 返回首页</button>
            
            <!-- 加载指示器 -->
            <div id="loading-indicator">
                <div class="spinner"></div>
                <p class="loading-text">✨ 故事正在生成中，请稍候... ✨</p>
            </div>
            
            <div id="story-content" class="hidden">
                <!-- 左右分栏布局 -->
                <div class="story-layout">
                    <!-- 左侧：图片和题目区域 -->
                    <div class="left-content-area">
                        <!-- 场景图片区域 -->
                        <div class="scene-image-area">
                            <div id="scene-image-container">
                                <div class="image-loading" id="image-loading">
                                    <div class="image-spinner"></div>
                                    <p>正在生成场景图片...</p>
                                </div>
                                <img id="scene-image" class="hidden" alt="场景图片">
                            </div>
                        </div>
                        
                        <!-- 故事和题目区域 -->
                        <div class="story-question-area">
                            <!-- 故事情景阶段 -->
                            <div id="story-stage-1" class="story-stage">
                                <div id="story-text"></div>
                            </div>
                            
                            <!-- 故事结尾阶段 -->
                            <div id="story-ending-stage" class="story-stage hidden">
                                <h3>故事继续...</h3>
                                <div id="story-ending-text"></div>
                                <button id="continue-adventure-btn">继续冒险</button>
                            </div>
                            
                            <div id="feedback-area"></div>
                        </div>
                    </div>
                    
                    <!-- 右侧：答题区域 -->
                    <div class="right-answer-area">
                        <!-- 数学题目区域 -->
                        <div id="question-area" class="hidden">
                            <h3>数学挑战</h3>
                            <p id="question-text"></p>
                        </div>
                        
                        <div class="answer-section">
                            <!-- 填空题答案输入 -->
                            <div id="fill-blank-answer" class="answer-type">
                                <input type="text" id="answer-input" placeholder="输入你的答案（如：12 或 1/2）">
                                
                                <!-- 九宫格数字键盘 -->
                                <div id="number-keyboard" class="number-keyboard">
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="7">7</button>
                                        <button class="num-btn" data-value="8">8</button>
                                        <button class="num-btn" data-value="9">9</button>
                                    </div>
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="4">4</button>
                                        <button class="num-btn" data-value="5">5</button>
                                        <button class="num-btn" data-value="6">6</button>
                                    </div>
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="1">1</button>
                                        <button class="num-btn" data-value="2">2</button>
                                        <button class="num-btn" data-value="3">3</button>
                                    </div>
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="/">/</button>
                                        <button class="num-btn" data-value="0">0</button>
                                        <button class="num-btn delete-btn" data-value="delete">⌫</button>
                                    </div>
                                </div>
                                
                                <button id="submit-answer-btn">提交答案</button>
                            </div>
                            
                            <!-- 选择题选项 -->
                            <div id="multiple-choice-answer" class="answer-type hidden">
                                <div class="choice-options">
                                    <button class="choice-btn" data-choice="A" id="choice-A">A. </button>
                                    <button class="choice-btn" data-choice="B" id="choice-B">B. </button>
                                    <button class="choice-btn" data-choice="C" id="choice-C">C. </button>
                                    <button class="choice-btn" data-choice="D" id="choice-D">D. </button>
                                </div>
                                
                                <!-- 选择题数字输入框 -->
                                <input type="text" id="choice-number-input" placeholder="或直接输入数字答案" style="margin: 10px 0; padding: 10px; border-radius: 8px; border: 2px solid #ddd; font-size: 16px; text-align: center;">
                                
                                <!-- 选择题也添加数字键盘，用于输入数字答案 -->
                                <div id="choice-number-keyboard" class="number-keyboard">
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="7">7</button>
                                        <button class="num-btn" data-value="8">8</button>
                                        <button class="num-btn" data-value="9">9</button>
                                    </div>
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="4">4</button>
                                        <button class="num-btn" data-value="5">5</button>
                                        <button class="num-btn" data-value="6">6</button>
                                    </div>
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="1">1</button>
                                        <button class="num-btn" data-value="2">2</button>
                                        <button class="num-btn" data-value="3">3</button>
                                    </div>
                                    <div class="keyboard-row">
                                        <button class="num-btn" data-value="/">/</button>
                                        <button class="num-btn" data-value="0">0</button>
                                        <button class="num-btn delete-btn" data-value="delete">⌫</button>
                                    </div>
                                </div>
                                
                                <button id="submit-choice-btn" class="hidden">提交答案</button>
                            </div>
                            
                            <button id="hint-btn" class="hint-btn">💡 需要提示？</button>
                        </div>
                        
                        <!-- 提示阶段 -->
                        <div id="hint-stage" class="story-stage hidden">
                            <h3>解题提示</h3>
                            <div id="hint-content"></div>
                            <button id="back-to-question-btn">返回题目</button>
                        </div>
                        

                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/shuxueyouxi-script.js"></script>
</body>
</html>